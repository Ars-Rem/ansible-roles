---
- name: deploy  / build server
  hosts: deploy
  roles:

  - role: preconfig
    tags: preconfig
  - role: build
    tags: build
  - role: deploy
    tags: deploy
  - role: swarm_init
    tags: swarm_init
# - role:swarm_init
# test: 0  
#    - role: deploy

#    - role: deploy
#      message: "mes1"
#    - role: deploy
#      message: "mes2"  
    
- name: manager
  hosts: managers
  roles: 
    - role: preconfig
      tags: preconfig
    - role: swarm_init
      type: manager
      tags: swarm_init  
#    - swarm_join

- name: workers
  hosts: workers
  roles: 
    - role: preconfig
      tags: preconfig
    - role: swarm_init
      type: worker
      tags: swarm_init 
#    - swarm_join
